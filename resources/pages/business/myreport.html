<html lang="zh-CN"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.w3.org/1999/xhtml"
      layout:decorator="templetes/layout.html">

<head>
    <title>我的项目质量报告</title>
    <link href="/plugins/bootstrap-table/bootstrap-table.css" rel="stylesheet">
    <script src="/plugins/bootstrap-table/bootstrap-table.min.js"></script>
</head>


<div layout:fragment="content">
    <div class="panel-heading">
        <h4 class="panel-title">
            项目列表
        </h4>
    </div>
    <div class="panel-body">
        <div id="project-toolbar">

        </div>
        <table id="project-table">

        </table>
    </div>
    <script>
        getProjLst();

        function getProjLst() {
            $.ajax({
                type:"get",
                url:"/getProjWithReport",
                success:function (lst) {
                    console.log(lst);
                    initProjTable(lst);
                }
            });
        }

        function initProjTable(lst){
            $('#project-table').bootstrapTable({
                toolbar: '#project-toolbar',
                pageSize: 5,
                pageList: [5, 10, 15],
                pagination: 'true',
                search: 'true',
                columns:[{
                    field:'name',
                    align:'center',
                    title:'项目名'
                },{
                    field:'type',
                    align:'center',
                    title:'类型',
                    formatter:typeparse
                },{
                    field:'description',
                    align:'center',
                    title:'类型',
                    formatter:typeparse
                },{
                    field:'status',
                    align:'center',
                    title:'状态',
                    formatter:statusparse
                },{
                    align:'center',
                    title:'操作',
                    formatter:operatorbtn
                }],
                data: lst
            });
        }
        function typeparse(value, row, index) {
            if(row.type=='sm')return '小型';
            else if(row.type=='md')return'中型';
            else  return'大型';
        }
        function statusparse(value, row, index) {
            if(row.status==0)return '未启动';
            else if(row.status==1)return '未完成';
            else  return'已完成';
        }
        function operatorbtn(value,row,index) {
            if(row.report==-1){
                return '<button class="btn btn-sm btn-success mar-rgt" onclick="turnAlter(' + row.id + ')" >撰写报告</button>'
            }else{
                return '<button class="btn btn-sm btn-primary mar-rgt" onclick="turnCheck(' + row.report + ')" >编辑报告</button>'
            }
        }
    </script>

</div>


